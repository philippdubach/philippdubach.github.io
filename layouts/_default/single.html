{{ define "main" }}
<article class="post single{{ with .Section }} {{ . }}{{ end }}">
    <header class="post-header">
        <h1 class="post-title">
            {{ .Title }}
        </h1>
        {{ if not .Date.IsZero }}
        <div class="post-meta">
            By <a href="/about/" class="post-author">{{ .Site.Params.author }}</a>
            • <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
                {{ .Date.Format "January 2, 2006" }}
            </time>
            • {{ .FuzzyWordCount }} words
            • {{ .ReadingTime }} min read
            {{- with .Params.categories }} • {{ range $i, $cat := . }}{{ if $i }}, {{ end }}<a href="{{ "/categories/" | relURL }}{{ $cat | urlize }}/" class="post-category">{{ $cat }}</a>{{ end }}{{ end }}
            {{- if .Params.external_url }} • <a href="{{ .Params.external_url }}" target="_blank" rel="noopener">via</a>{{ end }}
            • <button type="button" id="share-link" title="Copy short link" aria-label="Copy short link" class="share-btn">∞</button>
            <span id="share-status"></span>
        </div>
        {{ end }}
    </header>
    {{ with .Params.takeaways }}
    <aside class="key-takeaways" aria-label="Key takeaways">
        <h2>Key Takeaways</h2>
        <ul>
            {{ range . }}<li>{{ . | markdownify }}</li>{{ end }}
        </ul>
    </aside>
    {{ end }}
    <div class="post-content">
        {{ .Content }}
    </div>
</article>

{{ if eq .Section "posts" }}

{{/* Newsletter CTA - inline signup form */}}
{{ partial "newsletter-cta.html" . }}

<hr class="footer-divider" aria-hidden="true">

{{/* Related Posts */}}
{{ partial "related.html" . }}
{{ end }}

{{ end }}