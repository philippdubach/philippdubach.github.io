{{- $baseUrl := "https://static.philippdubach.com" -}}
{{- $src := .Get "src" -}}
{{- $alt := .Get "alt" | default "" -}}
{{- $class := .Get "class" | default "" -}}
{{- $width := .Get "width" | default "80%" -}}

<picture style="display: block; width: {{ $width }}; margin: 0 auto;">
  <!-- Mobile: 320px-768px -->
  <source media="(max-width: 768px)" 
          srcset="{{ $baseUrl }}/cdn-cgi/image/width=320,quality=80,format=webp/{{ $src }} 320w,
                  {{ $baseUrl }}/cdn-cgi/image/width=480,quality=80,format=webp/{{ $src }} 480w,
                  {{ $baseUrl }}/cdn-cgi/image/width=640,quality=80,format=webp/{{ $src }} 640w"
          sizes="{{ if eq $width "80%" }}80vw{{ else }}{{ $width }}{{ end }}">
  
  <!-- Tablet: 768px-1024px -->
  <source media="(max-width: 1024px)" 
          srcset="{{ $baseUrl }}/cdn-cgi/image/width=768,quality=80,format=webp/{{ $src }} 768w,
                  {{ $baseUrl }}/cdn-cgi/image/width=1024,quality=80,format=webp/{{ $src }} 1024w"
          sizes="{{ if eq $width "80%" }}80vw{{ else }}{{ $width }}{{ end }}">
  
  <!-- Desktop: 1024px+ -->
  <source media="(min-width: 1025px)" 
          srcset="{{ $baseUrl }}/cdn-cgi/image/width=1200,quality=80,format=webp/{{ $src }} 1200w,
                  {{ $baseUrl }}/cdn-cgi/image/width=1600,quality=80,format=webp/{{ $src }} 1600w,
                  {{ $baseUrl }}/cdn-cgi/image/width=2000,quality=80,format=webp/{{ $src }} 2000w"
          sizes="{{ if eq $width "80%" }}80vw{{ else }}{{ $width }}{{ end }}">
  
  <!-- Fallback -->
  <img src="{{ $baseUrl }}/cdn-cgi/image/width=1200,quality=80/{{ $src }}" 
       alt="{{ $alt }}" 
       class="{{ $class }}"
       loading="lazy"
       style="width: 100%; height: auto; display: block;">
</picture>