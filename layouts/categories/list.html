{{ define "main" }}
<div class="archive">
    {{ if eq .Title "Categories" }}
    {{/* Main categories index page */}}
    <h1>Categories</h1>
    
    <div class="categories-grid">
        {{ range .Site.Taxonomies.categories }}
        <a href="{{ .Page.Permalink }}" class="category-card">
            <span class="category-name">{{ .Page.Title }}</span>
            <span class="category-count">{{ len .Pages }} posts</span>
        </a>
        {{ end }}
    </div>
    
    {{ else }}
    {{/* Individual category page */}}
    <h1>{{ .Title }}</h1>
    
    <p class="category-description">{{ len .Pages }} posts in this category</p>
    
    {{ $posts := .Pages.ByDate.Reverse }}
    {{ range $posts.GroupByDate "2006" }}
    <section class="year">
        <h2>{{ .Key }}</h2>
        {{ range .Pages }}
        <article class="archive-item">
            <div class="archive-meta">
                <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
                    {{ .Date.Format "Jan 2" }}
                </time>
            </div>
            <div class="archive-title">
                <a href="{{ .Permalink }}">
                    {{ .Title }}
                    {{ if in .Params.tags "Project" }}
                       <span class="project-tag">PROJECT</span>
                    {{ end }}
                </a>
            </div>
        </article>
        {{ end }}
    </section>
    {{ end }}
    {{ end }}
</div>
{{ end }}
