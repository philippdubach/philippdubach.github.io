<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    {{/* Content Security Policy - allows GoatCounter and necessary scripts */}}
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://gc.zgo.at https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://philippdubach.goatcounter.com https://weekly-top-goatcounter-api.philippd.workers.dev https://newsletter-api.philippd.workers.dev https://gc.zgo.at https://pdub.click; frame-ancestors 'self'; base-uri 'self';">
    
    {{/* Preconnect to external domains for faster resource loading */}}
    <link rel="preconnect" href="https://gc.zgo.at" crossorigin>
    <link rel="preconnect" href="https://static.philippdubach.com" crossorigin>
    <link rel="preconnect" href="https://pdub.click" crossorigin>
    <link rel="dns-prefetch" href="https://gc.zgo.at">
    <link rel="dns-prefetch" href="https://static.philippdubach.com">
    <link rel="dns-prefetch" href="https://pdub.click">
    
    {{/* SEO Meta Tags */}}
    <meta name="robots" content="{{ if .Params.robots }}{{ .Params.robots }}{{ else }}index, follow{{ end }}">
    {{/* Use seoTitle if available (for shorter SEO-optimized titles), otherwise use Title */}}
    {{- $pageTitle := .Params.seoTitle | default .Title -}}
    <title>
	{{- if .IsHome -}}
    	Home - {{ .Site.Params.site_name }}
	{{- else if $pageTitle -}}
    	{{ $pageTitle }} - {{ .Site.Params.site_name }}
	{{- else -}}
    	{{ .Site.Params.site_name }}
	{{- end -}}
	</title>
    <meta name="description" content="{{ if .Description }}{{ .Description }}{{ else }}{{ .Site.Params.description }}{{ end }}">

    {{/* Use post-specific keywords if available, otherwise site-wide */}}
    {{ if .Params.keywords }}
    <meta name="keywords" content="{{ delimit .Params.keywords "," }}">
    {{ else if .Site.Params.keywords }}
    <meta name="keywords" content="{{ delimit .Site.Params.keywords "," }}">
    {{ end }}

    {{ if .Site.Params.author }}
    <meta name="author" content="{{ .Site.Params.author }}">
    {{ end }}

    {{/* Hugo Generator */}}
    {{ hugo.Generator }}

    {{/* Canonical URL */}}
    <link rel="canonical" href="{{ .Permalink }}">
    
    {{/* RSS Feed */}}
    {{- with .OutputFormats.Get "RSS" }}
    <link href="{{ .RelPermalink }}" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}">
    <link href="{{ .RelPermalink }}" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }}">
    {{- end }}

	<style>
	{{ readFile "static/css/custom.css" | safeCSS }}
	</style>
    
    {{/* Favicons */}}
	<link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/svg+xml" href="/icons/favicon.svg" />
	<link rel="shortcut icon" href="/icons/favicon.ico" />
	<link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
	<meta name="apple-mobile-web-app-title" content="{{ .Site.Params.site_name | default 	.Site.Title }}" />
	<link rel="manifest" href="/icons/site.webmanifest" />
    <meta name="theme-color" content="{{ .Site.Params.theme_color | default "#434648" }}">
    <meta name="msapplication-TileColor" content="{{ .Site.Params.msapplication_tile_color | default "#434648" }}">

    {{/* Open Graph */}}
    {{ partial "opengraph.html" . }}

    {{/* Twitter Cards */}}
    {{ partial "twitter.html" . }}

    {{/* Structured Data */}}
    {{ partial "structured-data.html" . }}
</head>